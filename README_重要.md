# 重要なお知らせ - Excelファイルの準備方法

## 現在の問題

ExcelJSライブラリが**共有数式（Shared Formula）**を正しく処理できないため、数式が含まれているExcelファイルを直接編集すると

エラーが発生します。

## 解決策

元のExcelファイルをExcelアプリで開いて、**数式を値に変換**してから使用してください。

### 手順

1. **元のExcelファイルを開く**
   - `【原本】R7確定申告フォーマット.xlsx` をExcel（またはNumbers/LibreOffice）で開く

2. **すべてのセルを選択**
   - `Cmd+A` (Mac) または `Ctrl+A` (Windows)

3. **コピー**
   - `Cmd+C` (Mac) または `Ctrl+C` (Windows)

4. **値として貼り付け**
   - 右クリック → 「形式を選択して貼り付け」 → 「値」を選択
   - または `Cmd+Shift+V` (Mac)

5. **別名で保存**
   - `【原本】R7確定申告フォーマット_数式なし.xlsx` として保存

6. **このファイルをアップロード**
   - Webアプリで「数式なし」バージョンを使用

## 代替案（今後の改善）

- Python + openpyxlを使用した別バージョンの作成
- ExcelファイルをCSVに変換してから処理
- Googleスプレッドシート経由での処理

## 注意事項

数式を値に変換すると、元の計算機能は失われますが、このアプリではPDFから抽出したデータを直接値として書き込むため、問題ありません。
