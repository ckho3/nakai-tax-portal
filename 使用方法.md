# PDF to Excel 自動入力アプリ - 使用方法

## 📌 重要: 初回準備(1回だけ必要)

Excelファイルに数式が含まれているため、以下の手順で準備してください:

### 1. Excelファイルを開く
```
【原本】R7確定申告フォーマット.xlsx
```

### 2. すべてのセルを選択
- **Mac**: `Cmd + A`
- **Windows**: `Ctrl + A`

### 3. コピー
- **Mac**: `Cmd + C`
- **Windows**: `Ctrl + C`

### 4. 値として貼り付け
- **Mac**: `Cmd + Shift + V`
- **Windows**: 右クリック → 「形式を選択して貼り付け」 → 「値」を選択

### 5. 別名で保存
```
【原本】R7確定申告フォーマット_数式なし.xlsx
```

この「数式なし」バージョンを今後使用してください。

---

## 🚀 アプリの起動方法

### 1. ターミナルを開く
アプリケーション → ユーティリティ → ターミナル

### 2. プロジェクトフォルダに移動
```bash
cd "/Users/user/Documents/中井システム/システム依頼 _最新/pdf-to-excel-app"
```

### 3. サーバーを起動
```bash
node server.js
```

以下のメッセージが表示されます:
```
========================================
PDF to Excel 自動入力アプリ
========================================
サーバーが起動しました
URL: http://localhost:3000
========================================
```

### 4. ブラウザでアクセス
```
http://localhost:3000
```

---

## 📤 ファイルのアップロード方法

### 1. Excelファイルを選択
- 「Excelテンプレートを選択」ボタンをクリック
- `【原本】R7確定申告フォーマット_数式なし.xlsx` を選択

### 2. PDFファイルを選択
- 「PDFファイルを選択」ボタンをクリック
- 複数のPDFファイルを選択(最大50件)
- または、ドラッグ&ドロップでファイルを追加

### 3. アップロード
- 「アップロード」ボタンをクリック
- 処理が完了するまで待機(数秒〜数十秒)

### 4. ダウンロード
- 「ダウンロード」ボタンが表示されます
- クリックして更新されたExcelファイルをダウンロード

---

## 📊 処理結果の見方

### 成功時
```
✓ ＫＡＩＳＥＩ梅田 808 - 新規追加しました (Row 55)
✓ Rising place 桜木町二番館 302 - 新規追加しました (Row 56)
```

### エラー時
```
✗ ファイル名.pdf - 物件名が抽出できませんでした
```

---

## 🛑 サーバーの停止方法

ターミナルで以下のキーを押す:
- **Mac/Windows**: `Ctrl + C`

---

## ❓ トラブルシューティング

### 「PDFファイルまたはExcelファイルのみアップロード可能です」
→ ファイル拡張子が `.pdf` または `.xlsx` であることを確認

### 「物件名が抽出できませんでした」
→ PDFのフォーマットが想定と異なる可能性があります
→ PDFを開いて「管理物件名」という項目があるか確認

### 「エクセルの更新に失敗しました: Shared Formula...」
→ Excelファイルに数式が残っています
→ 上記の「初回準備」手順を実行してください

### ポート3000が使用中
→ 以下のコマンドで別のポートを使用:
```bash
PORT=3001 node server.js
```
→ ブラウザで `http://localhost:3001` にアクセス

---

## 📁 出力ファイルの場所

ダウンロードしたファイルは以下の形式で保存されます:
```
【原本】R7確定申告フォーマット_数式なし_updated_2024-12-09T12-34-56.xlsx
```

---

## 💡 ヒント

- PDFファイルは50件まで同時処理可能
- 同じ物件名が見つかった場合は上書き更新されます
- 新しい物件は自動的に次の空き行に追加されます
- 処理後のExcelファイルには元のフォーマットと書式が保持されます
