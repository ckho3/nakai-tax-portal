# PDF to Excel 自動入力アプリ

年間収支一覧表PDFを自動的にExcelに転記するWebアプリケーションです。

## 機能

- 複数のPDFファイルを一括アップロード
- PDFから不動産収支データを自動抽出
- Excelファイルの該当箇所に自動入力
- 処理結果の詳細表示
- 更新されたExcelファイルのダウンロード

## 必要な環境

- Node.js v14以上
- npm

## インストール

```bash
cd pdf-to-excel-app
npm install
```

## 使い方

### 1. サーバーを起動

```bash
npm start
```

サーバーが起動すると、以下のURLが表示されます：
```
http://localhost:3000
```

### 2. ブラウザでアクセス

ブラウザで `http://localhost:3000` を開きます。

### 3. ファイルをアップロード

1. **Excelファイルを選択**
   - 「【原本】R7確定申告フォーマット(伊藤入力済).xlsx」など

2. **PDFファイルを選択（複数可）**
   - 「年間収支一覧表書_2024_リーガル北梅田903.pdf」など
   - 複数選択可能

3. **処理を開始**ボタンをクリック

### 4. 処理完了

- 処理結果が表示されます
- 「更新されたExcelファイルをダウンロード」ボタンからダウンロード

## ディレクトリ構造

```
pdf-to-excel-app/
├── package.json          # プロジェクト設定
├── server.js             # Expressサーバー
├── pdfParser.js          # PDF解析機能
├── excelWriter.js        # Excel書き込み機能
├── public/               # フロントエンド
│   ├── index.html
│   ├── style.css
│   └── script.js
├── uploads/              # 一時アップロードディレクトリ
└── output/               # 出力ファイルディレクトリ
```

## 処理の流れ

1. ユーザーがExcelファイルと複数のPDFをアップロード
2. サーバーが各PDFファイルからデータを抽出
   - 物件名
   - 月別賃料（1月〜12月）
   - 管理手数料
   - 設備交換費
   - 宣伝広告費
3. 物件名をキーにExcelファイルの該当行を検索
4. 抽出したデータをExcelに書き込み
   - 【A】収入セクション → 月別賃料
   - 【B】管理手数料セクション → 管理手数料
   - 【C】広告費等セクション → 宣伝広告費
   - 【D】修繕費・設備費セクション → 設備交換費
5. 更新されたExcelファイルを出力

## 対応しているPDFフォーマット

- RENOSY ASSET MANAGEMENT発行の年間収支一覧表
- 物件名、月別賃料、各種経費が記載されているPDF

## トラブルシューティング

### PDFが正しく解析されない場合

- PDFのフォーマットが想定と異なる可能性があります
- エラーメッセージを確認してください

### Excelに該当物件が見つからない場合

- 物件名の表記が異なる可能性があります
- Excelファイルに該当物件が存在するか確認してください

### サーバーが起動しない場合

```bash
# ポート3000が使用中の場合、別のポートを指定
PORT=3001 npm start
```

## 開発モード

開発時は自動再起動機能付きのnodemonを使用できます：

```bash
npm run dev
```

## 注意事項

- アップロードされたファイルは処理後に自動削除されます
- 出力ファイルは `output/` ディレクトリに保存されます
- ファイル名にはタイムスタンプが付与されます

## ライセンス

ISC
